{% extends 'admin_temp/base.html' %}
{% load static %} {# Load static if you need it for images, CSS, etc. #}

{% block title %}Admin Dashboard{% endblock %} {# Set the page title #}

{% block main_content %}
<main class="content">

    <div class="container-fluid p-0">

        {# --- Display Messages --- #}
        {% if messages %}
            <ul class="messages">
                {% for message in messages %}
                    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        {# --- End Messages --- #}

        <h1 class="h3 mb-3"><strong>Admin</strong> Dashboard Overview</h1> {# Updated Heading #}

        <div class="row">

            {# Card for Total Books #}
            <div class="col-sm-6 col-xl-3"> {# Adjusted column size for better layout #}
                <div class="card">
                    <div class="card-body">
                         <div class="row">
                            <div class="col mt-0">
                                <h5 class="card-title">Total Books</h5> {# Updated Title #}
                            </div>
                            <div class="col-auto">
                                <div class="stat text-primary">
                                    {# Feather icon for books #}
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book align-middle me-2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                                </div>
                            </div>
                        </div>
                        {# --- Updated: Use the correct variable for book count --- #}
                        <h1 class="mt-1 mb-3">{{ books_count }}</h1>
                        {# --- Add links related to books --- #}
                        <a href="{% url 'view_books' %}" class="mb-0 text-muted">View All Books &rarr;</a><br> {# Existing link #}
                         <a href="{% url 'available_books_report' %}" class="mb-0 text-success">View Available Books &rarr;</a> {# Existing link #}
                        {# --- End Updated Links --- #}
                    </div>
                </div>
            </div>

             {# Card for Active Issued Books #}
            <div class="col-sm-6 col-xl-3"> {# Adjusted column size #}
                <div class="card">
                    <div class="card-body">
                         <div class="row">
                            <div class="col mt-0">
                                <h5 class="card-title">Books Issued (Active)</h5> {# Updated Title #}
                            </div>
                            <div class="col-auto">
                                <div class="stat text-primary">
                                     {# Feather icon for open book #}
                                     <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book-open align-middle me-2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                                </div>
                            </div>
                        </div>
                        {# --- Updated: Use the correct variable for issued books count --- #}
                        <h1 class="mt-1 mb-3">{{ issued_books_count }}</h1>
                        {# --- Add link to View Issued Books page --- #}
                        <a href="{% url 'view_issued_book' %}" class="mb-0 text-muted">View Issued Books &rarr;</a>
                        {# --- Removed Overdue link from here to put it in its own card --- #}
                        {# <a href="{% url 'overdue_books_report' %}" class="mb-0 text-danger">View Overdue Books &rarr;</a> #}
                        {# --- End Updated Links --- #}
                    </div>
                </div>
            </div>

             {# Card for Overdue Books (New Card) #}
            <div class="col-sm-6 col-xl-3"> {# Adjusted column size #}
                <div class="card">
                    <div class="card-body">
                         <div class="row">
                            <div class="col mt-0">
                                <h5 class="card-title">Overdue Books</h5> {# New Card Title #}
                            </div>
                            <div class="col-auto">
                                <div class="stat text-danger"> {# Using text-danger for overdue #}
                                     {# Feather icon for alert-circle or similar #}
                                     <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-circle align-middle me-2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                                </div>
                            </div>
                        </div>
                        {# --- Updated: Use the new variable for overdue count --- #}
                        <h1 class="mt-1 mb-3">{{ overdue_count }}</h1>
                        {# --- Add link to Overdue Books Report page --- #}
                        <a href="{% url 'overdue_books_report' %}" class="mb-0 text-danger">View Overdue Books &rarr;</a>
                        {# --- End Updated --- #}
                    </div>
                </div>
            </div>


             {# Card for Total Students #}
            <div class="col-sm-6 col-xl-3"> {# Adjusted column size #}
                <div class="card">
                    <div class="card-body">
                         <div class="row">
                            <div class="col mt-0">
                                <h5 class="card-title">Total Students</h5> {# Updated Title #}
                            </div>
                            <div class="col-auto">
                                <div class="stat text-primary">
                                    {# Feather icon for users #}
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-users align-middle me-2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                                </div>
                            </div>
                        </div>
                         {# --- Updated: Use the correct variable for student count --- #}
                        <h1 class="mt-1 mb-3">{{ student_count }}</h1>
                         {# --- Add link to View Students page --- #}
                         <a href="{% url 'view_students' %}" class="mb-0 text-muted">View All Students &rarr;</a>
                        {# --- End Updated --- #}
                    </div>
                </div>
            </div>

            {# Card for Active Holds #}
            <div class="col-sm-6 col-xl-3"> {# Adjusted column size #}
                <div class="card">
                    <div class="card-body">
                         <div class="row">
                            <div class="col mt-0">
                                <h5 class="card-title">Active Holds</h5> {# New Card Title #}
                            </div>
                            <div class="col-auto">
                                <div class="stat text-primary">
                                    {# Feather icon for bookmark or similar #}
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bookmark align-middle me-2"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path></svg>
                                </div>
                            </div>
                        </div>
                        {# --- Updated: Use the correct variable for active holds count --- #}
                        <h1 class="mt-1 mb-3">{{ holds_count }}</h1>
                        {# --- Add link to Admin View Holds page --- #}
                        <a href="{% url 'admin_view_holds' %}" class="mb-0 text-muted">View All Holds &rarr;</a>
                        {# --- End Updated --- #}
                    </div>
                </div>
            </div>

            {# Removed the hardcoded "Administrators" card #}
            {% comment %}
            <div class="col-sm-6 col-xl-3">
                 <div class="card">
                     <div class="card-body">
                          <div class="row">
                             <div class="col mt-0">
                                 <h5 class="card-title">Administrators</h5>
                             </div>
                             <div class="col-auto">
                                 <div class="stat text-primary">
                                     <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user align-middle me-2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                                 </div>
                             </div>
                         </div>
                         <h1 class="mt-1 mb-3">1</h1> {# Hardcoded #}
                         <div class="mb-0">
                             <span class="text-muted">Admin</span>
                         </div>
                     </div>
                 </div>
             </div>
             {% endcomment %}
             {# Optional: Add a card for Total Users if different from Students #}
             {% comment %}
             <div class="col-sm-6 col-xl-3">
                  <div class="card">
                      <div class="card-body">
                           <div class="row">
                              <div class="col mt-0">
                                  <h5 class="card-title">Total Users</h5>
                              </div>
                              <div class="col-auto">
                                  <div class="stat text-primary">
                                       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-users align-middle me-2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                                  </div>
                              </div>
                          </div>
                          <h1 class="mt-1 mb-3">{{ user_count }}</h1> {# Use the user_count variable #}
                          <a href="#" class="mb-0 text-muted">View All Users &rarr;</a> {# Link if you have a view for all users #}
                      </div>
                  </div>
              </div>
              {% endcomment %}

        </div> {# End row #}

         {# Potential area for charts, recent activity, etc. #}
        {% comment %}
        <div class="row">
            <div class="col-xl-6 col-xxl-7">
                <div class="card flex-fill w-100">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Recent Activity</h5>
                    </div>
                    <div class="card-body py-3">
                        {# Add recent issues, returns, or hold activities here #}
                        <p>Display recent library activity here...</p>
                    </div>
                </div>
            </div>
            <div class="col-xl-6 col-xxl-5 d-flex">
                <div class="card flex-fill w-100">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Book Trends (Example Chart)</h5>
                    </div>
                    <div class="card-body py-3">
                        {# Add a chart here, e.g., using Chart.js and passing data from the view #}
                        <canvas id="chartjs-dashboard-line"></canvas>
                    </div>
                </div>
            </div>
        </div>
        {% endcomment %}


    </div> {# End container-fluid #}

</main>

{% endblock main_content %}
{% block js %}
    {# Add any specific JavaScript needed for this page here #}
    {# Ensure your base template includes the Feather icons script if you're using them #}
    {# If adding charts, include the Chart.js library and your chart rendering script #}
{% endblock js%}